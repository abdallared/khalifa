from django.core.management.base import BaseCommand
from conversations.models import GlobalTemplate, Admin


class Command(BaseCommand):
    help = 'Seed global templates for agent auto selection'

    def handle(self, *args, **options):
        admin = Admin.objects.select_related('user').first()
        if not admin:
            self.stderr.write('No Admin found. Create an admin user first.')
            return

        high = [
            ('حجز تمريض', 'للاسف التمريض غير موجود حاليا بالفرع ممكن احجز لحضرتك موعد للخروج فور رجوعه'),
            ('عميل جديد او كود', 'استأذن حضرتك رقم التليفون المسجل عليه الخدمة لو اول مرة تشرفنا بالتواصل ممكن اتشرف ببيانات حضرتك لتسجيل كود الاسم : رقم الموبيل : المنطقة /المجموعه : الشارع /رقم العمارة : الدور/رقم الشقه :'),
            ('اعتذار شكوي او تاخير', 'بعتذر جدا لحضرتك علي الخطأ الغير مقصود وتم تسجيل شكوي لحضرتك بالامر للمراجعه وعدم التكرار'),
            ('تحويل', 'استاذن حضرتك الاوردر هياخد وقت اطول لتوفير صنف من فرع آخر و إرسال الاوردر فور وصوله'),
            ('مثيل', 'للاسف الصنف غير متوفر حاليا لكن متوفر مثيل بنفس الماده الفعاله والتركيز'),
            ('بديل', 'للاسف الصنف غير متوفر حاليا لكن متوفر بديل'),
            ('نواقص', 'للاسف غير متوفر حاليا فيه امكانيه اسجل لحضرتك طلب وخدمه العملاء بتتواصل خلال 48ساعة بالتوفير او عدم التوفير'),
            ('اي اضافة آخرى', 'أي اضافه اخرى علي طلب حضرتك'),
            ('الاجمالي', 'اجمالي قيمة الاوردر ج شامل خدمة التوصيل'),
            ('تم تنفيذ الاوردر', 'تم تنفيذ الاوردر لحضرتك ... شاركنا تقييمك في حال الاعطال الفنيه رجاء التواصل لطلب اوردرك علي اراقام الواتساب التالية'),
            ('استبيان التمريض و تنفيذ الاوردر', 'تم تنفيذ الاوردر حرصاً منا على تقديم الأفضل والأقيم لكم، نأمل مشاركتنا بالاستبيان التالي لمعرفة مدى رضاكم عن الخدمة التمريضيه المقدمة'),
            ('المندوب', 'بنعتذر عن اي تاخير سيتم استعجال الاوردر لحضرتك و التأكد من خروجه'),
            ('غير متاح عرض', 'للاسف غير متاح عرض حاليا .. برجاء متابعة صفحتنا على الفيس بوك لمتابعة العروض الجديدة او على صفحة الانستاجرام'),
            ('انتظار تاكيد', 'في انتظار تاكيد حضرتك لتنفيذ الاوردر'),
            ('التواصل مع المندوب', 'المندوب تعذر عن الوصول لحضرتك لعدم وجود رد أو الرقم خارج نطاق الخدمة برجاء التواصل معه لاستلام الاوردر علي الرقم التالي'),
            ('اساعد حضرتك', 'أقدر اساعد حضرتك ازاي؟'),
            ('صور منتجات', 'رابط صورة المنتج'),
            ('شكرا', 'شكرا لاختياركم صيدليات خليفة'),
            ('ضغط الاوردرات', 'بنعتذر لحضراتكم عن التاخير فى الرد لضغط الاوردرات جاري مراجعه طلبكم'),
            ('جاري التحضير', 'جاري التحضير'),
            ('لحظات للتأكد', 'لحظات للتأكد'),
            ('مساء الخير', 'مساء الخير صيدليات خليفه [[name]] مع حضرتك'),
            ('صباح الخير', 'صباح الخير صيدليات خليفه [[name]] مع حضرتك'),
            ('وعليكم السلام', 'وعليكم السلام و رحمة الله صيدليات خليفه [[name]] مع حضرتك'),
        ]

        low = [
            ('غير متاح خصم', 'للاسف يا فندم غير متوفر عمل خصم لكن احنا بنحاول نعوض حضرتك بخدمات اخري زي خدمة الدليفري داخل المدن بدون حد ادني 24 ساعة و خدمة طلبات العملاء عند عدم توفر صنف من شركة المنتجة و خدمة الاستشارات الطبية'),
            ('شروط مضاد حيوي', 'اعطاء المضادات الحيوية بيكون للحقن المباعة من طرف صيدليات خليفة فقط بعد عمل اختبار حساسية قبل كل حقنة فى حالة رغبة حضرتك فى اعطاء الحقنه الغير مباعه من طرف الصيدليه استأذن حضرتك هتكون على مسؤلية حضرتك الشخصيه بعد عمل اختبار حساسية'),
            ('عناوين الفروع', 'فروعنا في المنصورة: ... فروعنا في القاهرة: ...'),
            ('دفع فودافون كاش', 'للدفع عن طريق فودافون كاش يرجي ارسال المبلغ علي رقم 01007301820 و ارسال صورة الدفع لتنفيذ الاوردر'),
            ('للدفع انستاباي', 'للدفع عن طريق انستاباي اضغط الرابط لارسال نقود الى mo.hamada@instapay في انتظار ارسال صورة الدفع لتنفيذ الاوردر'),
            ('فتح استشارة', 'السن كام سنة ؟ - امتي بدأت الأعراض و هل أخدنا اي علاج ليها ؟ - هل فيه حمل أو رضاعه ؟'),
            ('استكمال استشارة', 'هل بنعاني من أي امراض مزمنة او ماشيين علي أي ادويه حاليا ؟ - هل تم زيارة الطبيب بشأن المشكلة أو متاح اي تحاليل متعلقه بيها ؟ - فيه حساسية معروفة تجاه أي دواء ؟'),
            ('مرتجع', 'سيتم تخصيم قيمة المرتجع مع الاوردر التالي لحضرتك في خلال ١٤ يوم أو يمكنك زيارة اقرب فرع لحضرتك في اي وقت للفحص فى حالة الرغبة فى احضار المرتجع فى الوقت الحالى سيتم تحصيل قيمة التوصيل 7 ج'),
            ('فورم التوظيف', 'التقديم من خلال الابلكيشن أو في المقر الاداري ... ولتفاصيل اكتر و الاستفسار التواصل مع رقم الموارد البشرية على واتساب ...'),
            ('فاتوره ضريبيه', 'الفاتوره الضريبيه حاليا بتتم بشكل اليكتروني عن طريق هيئة الضرائب وسيتم ارسال الفاتوره الاليكترونيه لحضرتك غدا على الواتساب استأذن حضرتك فى ارسال صورة البطاقة الشخصيه / رقم البطاقه الضريبيه لتأكيد ارسال الفاتوره'),
            ('خدمة التوصيل', 'تم اضافه خدمة التوصيل لضمان الحفاظ على افضل مستوى خدمة نقدمه لسيادتكم بجانب الاستفاده من الخدمات الاخرى مثل الاستشارات الطبيه والتجميليه والتمريض المنزلى'),
            ('اضافة بعد خروج الاوردر', 'اوردر حضرتك خرج بالفعل مع المندوب سيتم ارسال الاوردر مع مندوب اخر بقيمة توصيل جديده'),
            ('تم تسجيل طلب', 'تم تسجيل طلب لحضرتك'),
            ('عطل فني', 'بنعتذر لوجود عطل فني منعنا من مساعدة حضرتك برجاء اعادة ارسال طلبك'),
            ('تحويل استشارات', 'لحظات لتحويل حضرتك لقسم الاستشارات الطبية'),
            ('خدمات التمريض', 'نوفر خدمة التمريض المنزلي من خلال طاقم تمريضي مُدرب، ذوي خبرة في التعامل مع كافة الحالات هل أرسل ممرض مع الاوردر ؟'),
            ('تلف منتج', 'سيتم تحصيل خدمة التوصيل للاستلام و الارجاع و سيتم رد المبلغ لحضرتك في حال التاكد من تلف المنتج'),
            ('ارسال الاصناف المتوفرة', 'فيه امكانيه يا فندم ارسل لحضرتك الاصناف المتوفرة حاليا بالفرع و ارسل الصنف المحول حين وصوله بدون خدمة اضافيه'),
            ('تحويل ماسنجر لواتساب', 'عميلنا العزيز لتفاصيل اكثر والتحدث مع قسم المبيعات او الاستشارات الطبيه يرجي التواصل علي ارقامنا من خلال الرقم الموحد 19045 او من خلال الواتساب 24ساعه بالضغط علي اللينك'),
        ]

        created = 0
        for name, content in high:
            obj, was_created = GlobalTemplate.objects.get_or_create(
                name=name,
                defaults={
                    'content': content,
                    'category': 'HIGH',
                    'is_active': True,
                    'created_by': admin,
                    'updated_by': admin,
                }
            )
            if not was_created:
                obj.content = content
                obj.category = 'HIGH'
                obj.is_active = True
                obj.updated_by = admin
                obj.save()
            created += 1

        for name, content in low:
            obj, was_created = GlobalTemplate.objects.get_or_create(
                name=name,
                defaults={
                    'content': content,
                    'category': 'LOW',
                    'is_active': True,
                    'created_by': admin,
                    'updated_by': admin,
                }
            )
            if not was_created:
                obj.content = content
                obj.category = 'LOW'
                obj.is_active = True
                obj.updated_by = admin
                obj.save()
            created += 1

        self.stdout.write(self.style.SUCCESS(f'Seeded {created} templates'))
