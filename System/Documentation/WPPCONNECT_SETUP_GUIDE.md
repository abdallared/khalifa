# ๐ฑ ุฏููู ุฅุนุฏุงุฏ WPPConnect - ุตูุฏููุงุช ุฎูููุฉ

## ๐ ูุธุฑุฉ ุนุงูุฉ

ูุฐุง ุงูุฏููู ูุดุฑุญ ููููุฉ ุฅุนุฏุงุฏ ูุชุดุบูู WPPConnect ููุฑุจุท ูุน WhatsApp ูู ูุธุงู ุฅุฏุงุฑุฉ ุงููุญุงุฏุซุงุช.

---

## ๐ฏ ูุง ูู WPPConnectุ

**WPPConnect** ูู ููุชุจุฉ Node.js ุชุณูุญ ุจุงูุชุญูู ูู WhatsApp Web ูู ุฎูุงู API.

**ุงููููุฒุงุช:**
- โ ุฅุฑุณุงู ูุงุณุชูุจุงู ุงูุฑุณุงุฆู
- โ QR Code ููุฑุจุท
- โ ุฏุนู ุงููุณุงุฆุท (ุตูุฑุ ููุฏููุ ูููุงุช)
- โ ุญุงูุฉ ุงูุชุณููู (Sent, Delivered, Read)
- โ ูุฌุงูู ูููุชูุญ ุงููุตุฏุฑ

---

## ๐ฆ ุงููุชุทูุจุงุช

### 1. Node.js
- **ุงูุฅุตุฏุงุฑ ุงููุทููุจ:** 14.x ุฃู ุฃุญุฏุซ
- **ุงูุชุญููู:** https://nodejs.org/

**ุงูุชุญูู ูู ุงูุชุซุจูุช:**
```bash
node --version
npm --version
```

### 2. Redis (ุงุฎุชูุงุฑู - ููุฃุฏุงุก ุงูุฃูุถู)
- **Windows:** https://github.com/microsoftarchive/redis/releases
- **Linux:** `sudo apt-get install redis-server`

**ุงูุชุญูู ูู ุงูุชุซุจูุช:**
```bash
redis-cli ping
# ูุฌุจ ุฃู ูุฑุฏ: PONG
```

---

## ๐ ุฎุทูุงุช ุงูุชุซุจูุช

### ุงูุฎุทูุฉ 1: ุชุซุจูุช ุงูุญุฒู

```bash
cd wppconnect-server
npm install
```

**ุงูุญุฒู ุงููุซุจุชุฉ:**
- `@wppconnect-team/wppconnect` - ุงูููุชุจุฉ ุงูุฃุณุงุณูุฉ
- `express` - ุฎุงุฏู HTTP
- `axios` - ูุฅุฑุณุงู Webhooks
- `redis` - ููุชุฎุฒูู ุงููุคูุช
- `dotenv` - ูุฅุฏุงุฑุฉ ุงููุชุบูุฑุงุช

---

### ุงูุฎุทูุฉ 2: ุฅุนุฏุงุฏ ููู `.env`

ุงูุณุฎ ููู `.env.example` ุฅูู `.env`:

```bash
cp .env.example .env
```

**ูุญุชูู ููู `.env`:**
```env
# Server Configuration
PORT=3000
NODE_ENV=development

# Django Backend
DJANGO_BACKEND_URL=http://localhost:8000
DJANGO_WEBHOOK_ENDPOINT=/api/whatsapp/webhook/

# Security
API_KEY=your-secret-api-key-change-this

# Redis (Optional)
REDIS_HOST=localhost
REDIS_PORT=6379
REDIS_PASSWORD=

# WhatsApp Session
SESSION_NAME=khalifa-pharmacy
```

**โ๏ธ ููู:** ุบููุฑ `API_KEY` ุฅูู ูููุฉ ุณุฑูุฉ ูููุฉ!

---

### ุงูุฎุทูุฉ 3: ุชุดุบูู ุงูุฎุงุฏู

```bash
npm start
```

**ุงููุงุชุฌ ุงููุชููุน:**
```
๐ WPPConnect Server started on port 3000
๐ฑ Session: khalifa-pharmacy
๐ Django Backend: http://localhost:8000
โ Server is ready!
```

---

## ๐ฑ ุฑุจุท WhatsApp

### ุงูุทุฑููุฉ 1: ุนุจุฑ API

**1. ุงุญุตู ุนูู QR Code:**
```bash
GET http://localhost:3000/qr-code
```

**ุงูุฑุฏ:**
```json
{
  "success": true,
  "qr_code": "data:image/png;base64,iVBORw0KG..."
}
```

**2. ุงูุณุญ ุงูู QR Code:**
- ุงูุชุญ WhatsApp ุนูู ูุงุชูู
- ุงุฐูุจ ุฅูู: **ุงูุฅุนุฏุงุฏุงุช** โ **ุงูุฃุฌูุฒุฉ ุงููุฑุชุจุทุฉ** โ **ุฑุจุท ุฌูุงุฒ**
- ุงูุณุญ ุงูู QR Code

**3. ุงูุชุธุฑ ุงูุงุชุตุงู:**
ุจุนุฏ ุงููุณุญุ ุณูุชุตู WPPConnect ุชููุงุฆูุงู.

---

### ุงูุทุฑููุฉ 2: ุนุจุฑ ุตูุญุฉ ุงูุฅุนุฏุงุฏุงุช

1. ุณุฌู ุฏุฎูู ูู **Admin**
2. ุงุฐูุจ ุฅูู: **ุงูุฅุนุฏุงุฏุงุช** โ **ุฅุนุฏุงุฏุงุช WhatsApp**
3. ุงุถุบุท ุนูู: **ุนุฑุถ ุฑูุฒ QR**
4. ุงูุณุญ ุงูู QR Code ูู ูุงุชูู

---

## ๐ API Endpoints

### 1. ุงูุญุตูู ุนูู QR Code
```http
GET /qr-code
```

**ุงูุฑุฏ:**
```json
{
  "success": true,
  "qr_code": "data:image/png;base64,..."
}
```

---

### 2. ุญุงูุฉ ุงูุงุชุตุงู
```http
GET /status
```

**ุงูุฑุฏ:**
```json
{
  "success": true,
  "connected": true,
  "phone": "201234567890"
}
```

---

### 3. ุฅุฑุณุงู ุฑุณุงูุฉ
```http
POST /send-message
Content-Type: application/json
X-API-Key: your-secret-api-key

{
  "phone": "201234567890",
  "message": "ูุฑุญุจุงู ูู ุตูุฏููุงุช ุฎูููุฉ!"
}
```

**ุงูุฑุฏ:**
```json
{
  "success": true,
  "message_id": "3EB0XXXXX"
}
```

---

## ๐ ููู ูุนูู ุงููุธุงูุ

### ุชุฏูู ุงูุฑุณุงุฆู ุงููุงุฑุฏุฉ:

```
1. ุนููู ูุฑุณู ุฑุณุงูุฉ WhatsApp
   โ
2. WPPConnect ูุณุชูุจู ุงูุฑุณุงูุฉ
   โ
3. WPPConnect ูุฑุณู Webhook ุฅูู Django
   POST /api/whatsapp/webhook/
   โ
4. Django ูุนุงูุฌ ุงูุฑุณุงูุฉ:
   - ููุดุฆ/ูุญุฏุซ ุงูุนููู
   - ููุดุฆ/ูุญุฏุซ ุงูุชุฐูุฑุฉ
   - ูุนูู ููุธู (Least Loaded)
   - ูุญูุธ ุงูุฑุณุงูุฉ
   โ
5. ุงูููุธู ูุฑู ุงูุฑุณุงูุฉ ูู ุตูุญุฉ ุงููุญุงุฏุซุงุช
```

---

### ุชุฏูู ุงูุฑุณุงุฆู ุงูุตุงุฏุฑุฉ:

```
1. ููุธู ููุชุจ ุฑุณุงูุฉ ูู ุงููุธุงู
   โ
2. Frontend ูุฑุณู AJAX ุฅูู Django
   POST /api/whatsapp/send/
   โ
3. Django ูุณุชุฎุฏู WhatsApp Driver
   โ
4. Driver ูุฑุณู ุทูุจ ุฅูู WPPConnect
   POST http://localhost:3000/send-message
   โ
5. WPPConnect ูุฑุณู ุงูุฑุณุงูุฉ ุนุจุฑ WhatsApp
   โ
6. ุงูุนููู ูุณุชูุจู ุงูุฑุณุงูุฉ ุนูู ูุงุชูู
```

---

## ๐๏ธ ุงุณุชูุดุงู ุงูุฃุฎุทุงุก

### ุงููุดููุฉ 1: QR Code ูุง ูุธูุฑ

**ุงูุญู:**
```bash
# ุฃุนุฏ ุชุดุบูู ุงูุฎุงุฏู
npm start

# ุงุญุฐู ุงูุฌูุณุฉ ุงููุฏููุฉ
rm -rf tokens/
```

---

### ุงููุดููุฉ 2: ุงูุงุชุตุงู ูููุทุน

**ุงูุฃุณุจุงุจ ุงููุญุชููุฉ:**
- โ ุงูุฅูุชุฑูุช ุถุนูู
- โ WhatsApp ููุชูุญ ุนูู ุงููุงุชู
- โ ุงูุฌูุณุฉ ุงูุชูุช

**ุงูุญู:**
```bash
# ุฃุนุฏ ุงูุงุชุตุงู
GET /qr-code
# ุงูุณุญ QR Code ูุฑุฉ ุฃุฎุฑู
```

---

### ุงููุดููุฉ 3: ุงูุฑุณุงุฆู ูุง ุชุตู

**ุงูุชุญูู:**
```bash
# 1. ุชุญูู ูู ุญุงูุฉ ุงูุงุชุตุงู
GET /status

# 2. ุชุญูู ูู logs
# ุงูุธุฑ ุฅูู terminal WPPConnect

# 3. ุชุญูู ูู API Key
# ุชุฃูุฏ ุฃู API_KEY ูู .env = WPPCONNECT_API_KEY ูู Django settings
```

---

## ๐ ุงููุฑุงูุจุฉ

### Logs

**WPPConnect Logs:**
```bash
# ูู terminal WPPConnect
๐ฑ Incoming message from 201234567890
โ Webhook sent to Django
๐ค Sending message to 201234567890
```

**Django Logs:**
```bash
# ูู terminal Django
[INFO] WhatsApp webhook received
[INFO] Customer created: 201234567890
[INFO] Ticket assigned to agent: Ahmed
[INFO] Message saved
```

---

## ๐ ุงูุฃูุงู

### 1. API Key

**โ๏ธ ููู ุฌุฏุงู:**
- ุบููุฑ `API_KEY` ูู `.env`
- ุงุณุชุฎุฏู ูููุฉ ุนุดูุงุฆูุฉ ูููุฉ (32+ ุญุฑู)
- ูุง ุชุดุงุฑู ุงูู API Key ูุน ุฃุญุฏ

**ุชูููุฏ API Key:**
```bash
# Linux/Mac
openssl rand -hex 32

# ุฃู ุงุณุชุฎุฏู ูููุน
https://www.uuidgenerator.net/
```

---

### 2. Firewall

**ุฅุฐุง ูุงู ุงูุฎุงุฏู ุนูู ุงูุฅูุชุฑูุช:**
- โ ุงุณูุญ ููุท ูู Django ุจุงููุตูู ููู Port 3000
- โ ูุง ุชูุชุญ Port 3000 ููุนุงูู

**ูุซุงู (Linux):**
```bash
# ุงุณูุญ ููุท ูู localhost
sudo ufw allow from 127.0.0.1 to any port 3000
```

---

## ๐ ุงูุฅูุชุงุฌ (Production)

### ุงุณุชุฎุฏุงู PM2

**1. ุชุซุจูุช PM2:**
```bash
npm install -g pm2
```

**2. ุชุดุบูู WPPConnect:**
```bash
cd wppconnect-server
pm2 start server.js --name wppconnect
```

**3. ุญูุธ ุงูุชูููู:**
```bash
pm2 save
pm2 startup
```

**4. ุงููุฑุงูุจุฉ:**
```bash
pm2 status
pm2 logs wppconnect
pm2 restart wppconnect
```

---

## ๐ ููุงุญุธุงุช ูููุฉ

### 1. ุฑูู WhatsApp

- โ ุงุณุชุฎุฏู ุฑูู ูุฎุตุต ูููุธุงู
- โ ูุง ุชุณุชุฎุฏู ุฑููู ุงูุดุฎุตู
- โ ุชุฃูุฏ ุฃู ุงูุฑูู ูุดุท

---

### 2. ุญุฏูุฏ WhatsApp

**โ๏ธ ุงูุชุจู:**
- ูุง ุชุฑุณู ุฃูุซุฑ ูู **1000 ุฑุณุงูุฉ/ููู** ููุฃุฑูุงู ุงูุฌุฏูุฏุฉ
- ูุง ุชุฑุณู ุฑุณุงุฆู spam
- ุงุญุชุฑู ุฎุตูุตูุฉ ุงูุนููุงุก

**ูุชุฌูุจ ุงูุญุธุฑ:**
- โ ุงุณุชุฎุฏู ููุงูุจ ููุฐุจุฉ
- โ ูุง ุชุฑุณู ุฑุณุงุฆู ูุชูุฑุฑุฉ
- โ ุงูุชุธุฑ ุฑุฏ ุงูุนููู ูุจู ุงูุฅุฑุณุงู ูุฑุฉ ุฃุฎุฑู

---

### 3. ุงููุณุฎ ุงูุงุญุชูุงุทู

**ุงุญูุธ ูุณุฎุฉ ูู:**
- โ ูุฌูุฏ `tokens/` (ุงูุฌูุณุฉ)
- โ ููู `.env`

**ุงุณุชุนุงุฏุฉ ุงูุฌูุณุฉ:**
```bash
# ุงูุณุฎ ูุฌูุฏ tokens ุงููุฏูู
cp -r backup/tokens/ wppconnect-server/tokens/
npm start
```

---

## โ ุงูุฎูุงุตุฉ

**ูุง ุชู ุฅูุฌุงุฒู:**
- โ WPPConnect Server ุฌุงูุฒ
- โ ุฑุจุท WhatsApp ุนุจุฑ QR Code
- โ ุงุณุชูุจุงู ุงูุฑุณุงุฆู ุชููุงุฆูุงู
- โ ุฅุฑุณุงู ุงูุฑุณุงุฆู ูู ุงููุธุงู
- โ Webhook ุฅูู Django
- โ Driver Pattern ูููุฑููุฉ

**ุงูุฎุทูุฉ ุงูุชุงููุฉ:**
- ๐ฑ ุฑุจุท WhatsApp ุจูุณุญ QR Code
- ๐งช ุงุฎุชุจุงุฑ ุฅุฑุณุงู ูุงุณุชูุจุงู ุงูุฑุณุงุฆู
- ๐จ ุงุณุชุฎุฏุงู ุตูุญุงุช Frontend

---

## ๐ ุงูุฏุนู

**ุฅุฐุง ูุงุฌูุช ูุดููุฉ:**
1. ุฑุงุฌุน ูุณู **ุงุณุชูุดุงู ุงูุฃุฎุทุงุก**
2. ุชุญูู ูู **Logs**
3. ุงุณุฃู ุงููุณุงุนุฏ ุงูุฐูู (Augment AI)

---

**ุชู ุฅุนุฏุงุฏ ูุฐุง ุงูุฏููู ุจูุงุณุทุฉ:** Augment AI Agent  
**ุงูุชุงุฑูุฎ:** 2025-10-30  
**ุงูุฅุตุฏุงุฑ:** 1.0.0

