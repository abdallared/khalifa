# ๐ ุฅุฏุงุฑุฉ ุงูุฌูุณุงุช - Session Management

## ูุธุฑุฉ ุนุงูุฉ

ุชู ุชูููู ุงููุธุงู ูุงุณุชุฎุฏุงู **ุฌูุณุงุช ุฏุงุฆูุฉ** ูุง ุชูุชูู ุฃุจุฏุงูุ ููุง ูุถูู ุจูุงุก ุงููุณุชุฎุฏููู ูุณุฌููู ุฏุฎูููู ุฏูู ุงูุญุงุฌุฉ ูุฅุนุงุฏุฉ ุชุณุฌูู ุงูุฏุฎูู.

---

## โ๏ธ ุงูุฅุนุฏุงุฏุงุช ุงููุทุจูุฉ

### 1. **ุฅุนุฏุงุฏุงุช Django (settings.py)**

```python
# Session Configuration - ุฌูุณุฉ ุฏุงุฆูุฉ ูุง ุชูุชูู ุฃุจุฏุงู
SESSION_ENGINE = 'django.contrib.sessions.backends.db'
SESSION_COOKIE_AGE = 86400 * 365 * 10  # 10 years - ุฌูุณุฉ ุดุจู ุฏุงุฆูุฉ
SESSION_SAVE_EVERY_REQUEST = True  # ุญูุธ ุงูุฌูุณุฉ ูุน ูู ุทูุจ
SESSION_EXPIRE_AT_BROWSER_CLOSE = False  # ูุง ุชูุชูู ุนูุฏ ุฅุบูุงู ุงููุชุตูุญ
SESSION_COOKIE_NAME = 'khalifa_sessionid'  # ุงุณู ูุฎุตุต ููู cookie
SESSION_COOKIE_HTTPONLY = True  # ุญูุงูุฉ ูู XSS
SESSION_COOKIE_SAMESITE = 'Lax'  # ุญูุงูุฉ ูู CSRF
```

### 2. **Middleware ูุฎุตุต (PermanentSessionMiddleware)**

ุชู ุฅูุดุงุก Middleware ูุฎุตุต ูููู ุจู:
- โ ุชุฌุฏูุฏ ุงูุฌูุณุฉ ุชููุงุฆูุงู ูุน ูู ุทูุจ
- โ ุชูุฏูุฏ ุตูุงุญูุฉ ุงูุฌูุณุฉ ููุฏุฉ 10 ุณููุงุช
- โ ุถูุงู ุนุฏู ุงูุชูุงุก ุงูุฌูุณุฉ ุฃุจุฏุงู

```python
class PermanentSessionMiddleware(MiddlewareMixin):
    def process_request(self, request):
        if request.user.is_authenticated:
            request.session.set_expiry(86400 * 365 * 10)
            request.session.modified = True
        return None
```

### 3. **ุชุนุฏูู Login View**

ุนูุฏ ุชุณุฌูู ุงูุฏุฎููุ ูุชู:
```python
# ุฌุนู ุงูุฌูุณุฉ ุฏุงุฆูุฉ - ูุง ุชูุชูู ุฃุจุฏุงู
request.session.set_expiry(86400 * 365 * 10)  # 10 ุณููุงุช
request.session.modified = True
```

---

## โ ุงูููุฒุงุช

### **1. ุฌูุณุฉ ุฏุงุฆูุฉ**
- โ ูุง ุชูุชูู ุงูุฌูุณุฉ ุฃุจุฏุงู (10 ุณููุงุช)
- โ ูุง ุญุงุฌุฉ ูุฅุนุงุฏุฉ ุชุณุฌูู ุงูุฏุฎูู
- โ ุชุจูู ุงูุฌูุณุฉ ุญุชู ุจุนุฏ ุฅุบูุงู ุงููุชุตูุญ

### **2. ุชุฌุฏูุฏ ุชููุงุฆู**
- โ ูุชู ุชุฌุฏูุฏ ุงูุฌูุณุฉ ูุน ูู ุทูุจ
- โ ูุง ููุฌุฏ timeout
- โ ุงููุณุชุฎุฏู ูุจูู ูุณุฌู ุฏุฎููู ุฏุงุฆูุงู

### **3. ุงูุฃูุงู**
- โ `SESSION_COOKIE_HTTPONLY = True` - ุญูุงูุฉ ูู XSS
- โ `SESSION_COOKIE_SAMESITE = 'Lax'` - ุญูุงูุฉ ูู CSRF
- โ ุงูุฌูุณุฉ ูุญููุธุฉ ูู Database

---

## ๐ ููู ูุนูู ุงููุธุงูุ

### **ุงูุณููุงุฑูู 1: ุชุณุฌูู ุงูุฏุฎูู**
```
1. ุงููุณุชุฎุฏู ูุฏุฎู Username + Password
   โ
2. Django ูุชุญูู ูู ุงูุจูุงูุงุช
   โ
3. ุชุณุฌูู ุงูุฏุฎูู ูุงุฌุญ
   โ
4. ุฅูุดุงุก Session ุฌุฏูุฏุฉ
   โ
5. ุชุนููู ุตูุงุญูุฉ ุงูุฌูุณุฉ = 10 ุณููุงุช
   โ
6. ุญูุธ Session ูู Database
   โ
7. ุฅุฑุณุงู Cookie ูููุชุตูุญ
```

### **ุงูุณููุงุฑูู 2: ูู ุทูุจ (Request)**
```
1. ุงููุณุชุฎุฏู ููุชุญ ุฃู ุตูุญุฉ
   โ
2. ุงููุชุตูุญ ูุฑุณู Session Cookie
   โ
3. PermanentSessionMiddleware ูุชุญูู
   โ
4. ุฅุฐุง ูุงู ุงููุณุชุฎุฏู ูุณุฌู ุฏุฎูู:
   - ุชุฌุฏูุฏ ุงูุฌูุณุฉ ููุฏุฉ 10 ุณููุงุช
   - ุญูุธ ุงูุชุบููุฑุงุช
   โ
5. ุงูุตูุญุฉ ุชูุนุฑุถ ุจูุฌุงุญ
```

### **ุงูุณููุงุฑูู 3: ุฅุบูุงู ุงููุชุตูุญ**
```
1. ุงููุณุชุฎุฏู ูุบูู ุงููุชุตูุญ
   โ
2. Session Cookie ูุญููุธ (ูุฃู EXPIRE_AT_BROWSER_CLOSE = False)
   โ
3. ุงููุณุชุฎุฏู ููุชุญ ุงููุชุตูุญ ูุฑุฉ ุฃุฎุฑู
   โ
4. ููุชุญ ุงููููุน
   โ
5. ูุง ูุฒุงู ูุณุฌู ุฏุฎููู โ
```

---

## ๐ ูุฏุฉ ุงูุฌูุณุฉ

| ุงูุฅุนุฏุงุฏ | ุงููููุฉ | ุงููุนูู |
|--------|--------|--------|
| `SESSION_COOKIE_AGE` | `86400 * 365 * 10` | 10 ุณููุงุช |
| ุจุงูุฃูุงู | `3650 ููู` | 10 ุณููุงุช |
| ุจุงูุณุงุนุงุช | `87,600 ุณุงุนุฉ` | 10 ุณููุงุช |
| ุจุงูุฏูุงุฆู | `5,256,000 ุฏูููุฉ` | 10 ุณููุงุช |

---

## ๐ก๏ธ ุงูุฃูุงู

### **ุงูุญูุงูุฉ ุงููุทุจูุฉ:**

1. **HttpOnly Cookie**
   - โ ูุง ูููู ุงููุตูู ููู Cookie ูู JavaScript
   - โ ุญูุงูุฉ ูู XSS Attacks

2. **SameSite = Lax**
   - โ ุญูุงูุฉ ูู CSRF Attacks
   - โ Cookie ููุฑุณู ููุท ูุน Same-Site Requests

3. **Database Backend**
   - โ Session ูุญููุธุฉ ูู Database
   - โ ูููู ุฅูุบุงุก ุงูุฌูุณุฉ ูู ุงูู Admin Panel

4. **Session Regeneration**
   - โ ูุชู ุชุฌุฏูุฏ ุงูุฌูุณุฉ ูุน ูู ุทูุจ
   - โ ููุน Session Fixation Attacks

---

## ๐ง ุฅุฏุงุฑุฉ ุงูุฌูุณุงุช

### **ุนุฑุถ ุฌููุน ุงูุฌูุณุงุช ุงููุดุทุฉ:**
```python
from django.contrib.sessions.models import Session
from datetime import datetime

# ุฌููุน ุงูุฌูุณุงุช ุงููุดุทุฉ
active_sessions = Session.objects.filter(expire_date__gte=datetime.now())
print(f"Active Sessions: {active_sessions.count()}")
```

### **ุญุฐู ุฌูุณุฉ ูุนููุฉ:**
```python
# ุญุฐู ุฌูุณุฉ ูุณุชุฎุฏู ูุนูู
Session.objects.filter(session_key='...').delete()
```

### **ุญุฐู ุฌููุน ุงูุฌูุณุงุช ุงูููุชููุฉ:**
```bash
python manage.py clearsessions
```

---

## ๐ ููุงุญุธุงุช ูููุฉ

### **1. ุชุณุฌูู ุงูุฎุฑูุฌ ุงููุฏูู**
- โ ุงููุณุชุฎุฏู ููููู ุชุณุฌูู ุงูุฎุฑูุฌ ูุฏููุงู ูู ุฒุฑ "ุชุณุฌูู ุงูุฎุฑูุฌ"
- โ ุนูุฏ ุชุณุฌูู ุงูุฎุฑูุฌุ ูุชู ุญุฐู ุงูุฌูุณุฉ ูู Database

### **2. ุชุณุฌูู ุงูุฎุฑูุฌ ูู Admin**
- โ Admin ููููู ุญุฐู ุฌูุณุฉ ุฃู ูุณุชุฎุฏู ูู Django Admin Panel
- โ ุงูุฐูุงุจ ุฅูู: `/admin/sessions/session/`

### **3. ุงูุฃูุงู ูู Production**
ุนูุฏ ุงููุดุฑ ุนูู Productionุ ูุฌุจ ุชูุนูู:
```python
SESSION_COOKIE_SECURE = True  # HTTPS only
CSRF_COOKIE_SECURE = True
SECURE_SSL_REDIRECT = True
```

---

## ๐ฏ ุงูุฎูุงุตุฉ

โ **ุงูุฌูุณุฉ ุฏุงุฆูุฉ** - ูุง ุชูุชูู ุฃุจุฏุงู (10 ุณููุงุช)  
โ **ุชุฌุฏูุฏ ุชููุงุฆู** - ูุน ูู ุทูุจ  
โ **ูุง ุชูุชูู ุนูุฏ ุฅุบูุงู ุงููุชุตูุญ**  
โ **ุขููุฉ** - HttpOnly + SameSite  
โ **ูุงุจูุฉ ููุฅุฏุงุฑุฉ** - ูู Admin Panel  

---

**ุชู ุฅุนุฏุงุฏ ูุฐุง ุงูููู ุจูุงุณุทุฉ:** Augment AI Agent  
**ุงูุชุงุฑูุฎ:** 2025-10-30  
**ุงูุฅุตุฏุงุฑ:** 1.0.0

